<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Consulta — Auxílio Moradia Coletivo</title>
  <meta name="robots" content="noindex, nofollow" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body { font-family: 'Inter', sans-serif; background-color: #0b1220; color: #111; }

    .hero {
      position: relative;
      min-height: 100vh;
      overflow: hidden;
      background-image:
        radial-gradient(1200px circle at 10% 10%, rgba(59, 130, 246, 0.22), transparent 55%),
        radial-gradient(900px circle at 90% 20%, rgba(34, 197, 94, 0.16), transparent 55%),
        linear-gradient(180deg, #0b1220 0%, #0f172a 60%, #0b1220 100%);
      background-repeat: no-repeat;
      background-size: cover;
      background-position: center;
    }

    .hero-overlay {
      position: relative;
      min-height: 100vh;
      width: 100%;
      background: linear-gradient(0deg, rgba(0,0,0,0.68), rgba(0,0,0,0.45));
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: #fff;
      padding: 20px;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      background: #f5b200;
      color: #111;
      font-weight: 800;
      padding: 10px 16px;
      border-radius: 999px;
      margin-bottom: 16px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.25);
      font-size: 16px;
    }

    .title {
      font-size: clamp(26px, 5vw, 42px);
      line-height: 1.1;
      margin-bottom: 14px;
      font-weight: 800;
      text-shadow: 0 2px 10px rgba(0,0,0,0.45);
    }

    .card {
      width: min(720px, 100%);
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.18);
      border-radius: 16px;
      box-shadow: 0 12px 26px rgba(0,0,0,0.28);
      padding: 16px;
      backdrop-filter: blur(6px);
      text-align: left;
    }

    .grid { display: grid; gap: 12px; }

    /* "Box" de seleção (CPF/NOME) */
    .chooser {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 4px;
    }
    .chip {
      flex: 1 1 220px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 12px 14px;
      border-radius: 14px;
      cursor: pointer;
      user-select: none;
      font-weight: 800;
      font-size: 18px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(255,255,255,0.08);
      color: #fff;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .chip:hover { transform: translateY(-1px); background: rgba(255,255,255,0.12); }
    .chip.active {
      background: rgba(245,178,0,0.20);
      border-color: rgba(245,178,0,0.65);
      box-shadow: 0 0 0 3px rgba(245,178,0,0.18);
    }
    .chip input { display: none; }

    .field label {
      display: block;
      font-weight: 800;
      font-size: 18px;
      margin-bottom: 6px;
      color: #fff;
    }

    .field input {
      width: 100%;
      padding: 14px 14px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(255,255,255,0.10);
      color: #fff;
      font-size: 18px;
      outline: none;
    }
    .field input::placeholder { color: rgba(255,255,255,0.72); }
    .field input:focus {
      border-color: rgba(245,178,0,0.85);
      box-shadow: 0 0 0 3px rgba(245,178,0,0.18);
    }

    .mini {
      margin-top: 6px;
      font-size: 14px;
      color: rgba(255,255,255,0.85);
      line-height: 1.25;
    }

    .actions {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 8px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 14px 18px;
      border-radius: 12px;
      font-weight: 800;
      font-size: 18px;
      cursor: pointer;
      border: 0;
      transition: transform .12s ease, opacity .12s ease;
      flex: 1 1 220px;
    }
    .btn:hover { transform: translateY(-1px); }
    .btn:disabled { opacity: .65; cursor: not-allowed; transform: none; }

    .btn-primary { background: #f5b200; color: #111; }
    .btn-ghost {
      background: rgba(255,255,255,0.10);
      color: #fff;
      border: 1px solid rgba(255,255,255,0.18);
    }

    /* Status invisível antes da busca */
    .status {
      display: none;
      margin-top: 12px;
      padding: 12px 14px;
      border-radius: 12px;
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.18);
      font-size: 18px;
      font-weight: 800;
      text-align: center;
      letter-spacing: .2px;
    }
    .status.show { display: block; }
    .status.ok { background: rgba(34,197,94,0.15); border-color: rgba(34,197,94,0.35); }
    .status.err { background: rgba(239,68,68,0.14); border-color: rgba(239,68,68,0.35); }

    .result {
      margin-top: 10px;
      padding: 14px;
      border-radius: 14px;
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.18);
    }
    .result .name {
      font-size: 20px;
      font-weight: 800;
      margin-bottom: 6px;
      text-transform: uppercase;
    }
    .result .cpf { font-size: 18px; opacity: 0.95; }

    .back {
      margin-top: 14px;
      text-align: center;
      opacity: 0.95;
    }
    .back a {
      color: #fff;
      text-decoration: none;
      font-weight: 700;
      padding: 10px 14px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(255,255,255,0.08);
      display: inline-flex;
      align-items: center;
      gap: 10px;
    }
    .back a:hover { background: rgba(255,255,255,0.12); }

    .hidden { display: none !important; }

    @media (max-width: 520px) {
      .card { padding: 14px; }
      .field label, .chip { font-size: 17px; }
      .field input { font-size: 18px; }
      .btn { font-size: 18px; }
      .status { font-size: 17px; }
    }
  
    /* Estilo para o header/nav utilizado em header.html */
    header { background-color: #003366; padding: 20px; color: white; }
    nav { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }
    .logo img { height: 50px; }
    nav ul { display: flex; list-style: none; gap: 20px; flex-wrap: wrap; }
    nav ul li { position: relative; }
    nav ul li a {
      color: white; text-decoration: none; font-weight: 600;
      padding: 8px 12px; display: block; transition: background-color 0.3s ease;
    }
    nav ul li a:hover { background-color: #005599; border-radius: 4px; }
    nav ul li ul {
      display: none; position: absolute; background-color: #004080;
      top: 100%; left: 0; min-width: 220px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2); z-index: 10;
    }
    nav ul li:hover ul { display: block; animation: fadeIn 0.3s ease-in-out; }
    nav ul li ul li a { padding: 10px; font-weight: 400; }

    /* Mobile menu (header.html) */
    .menu-toggle {
      display: none;
      cursor: pointer;
      font-size: 24px;
      color: white;
      margin-bottom: 10px;
    }
    #menu { display: flex; }

    @media (max-width: 768px) {
      nav { position: relative; flex-direction: column; align-items: center; }
      .logo { text-align: center; width: 100%; margin-bottom: 10px; }
      .menu-toggle { display: block; }
      #menu {
        display: none;
        flex-direction: column;
        position: relative;
        width: 100%;
        background-color: #003366;
        z-index: 1000;
      }
      #menu.active { display: flex; }
    }

  </style>
</head>

<body>

  <!-- HEADER carregado de header.html -->
  <div id="header-include" aria-label="Cabeçalho do site"></div>

  <section class="hero" aria-label="Consulta na lista">
    <div class="hero-overlay">
      <div class="badge" role="status" aria-live="polite">
        <i class="fa-solid fa-magnifying-glass"></i>
        <span>Auxílio Moradia Coletivo</span>
      </div>

      <h1 class="title">CONSULTE SEU NOME NA LISTAGEM</h1>

      <div class="card" aria-label="Formulário de consulta">
        <div class="grid">
          <div class="mini" style="font-size:16px; line-height:1.45; margin-bottom:6px;">
  <div style="font-weight:800; letter-spacing:.02em; margin-bottom:6px;">AUXÍLIO MORADIA COLETIVO</div>

  <div style="margin-bottom:10px;">
    A Associação orienta os interessados a consultarem a listagem inicial do <b>Auxílio Moradia Coletivo (2008)</b>
    para verificar se o seu nome, ou o nome da pensionista/inativo, consta entre os beneficiários.
  </div>

  <div style="padding:10px 12px; border-radius:14px; border:1px solid rgba(255,255,255,.14); background:rgba(255,255,255,.06); margin:10px 0 12px;">
    <div><b>Processo:</b> iniciado em 2014</div>
    <div><b>Ação Ordinária nº:</b> 20.675-13.2014.4.01.3400</div>
    <div><b>Prazo final para reivindicação de direitos (prescrição):</b> <span style="color:#f5b200; font-weight:800;">março de 2026</span></div>
  </div>

  <div style="margin-top:6px; font-weight:800;">Regras para recebimento dos valores</div>
  <ul style="margin:8px 0 12px 18px; padding:0;">
    <li style="margin:6px 0;">
      <b>Beneficiários vivos que constam na listagem:</b>
      têm direito ao recebimento dos valores do Auxílio Moradia referentes ao período de <b>setembro de 2014 a 2025</b>.
    </li>
    <li style="margin:6px 0;">
      <b>Beneficiários falecidos que constam na listagem:</b>
      os herdeiros têm direito ao recebimento dos valores do Auxílio Moradia referentes ao período de
      <b>setembro de 2014</b> até a <b>data do óbito</b>, observadas as regras legais aplicáveis.
    </li>
    <li style="margin:6px 0;">
      <b>Óbito ocorrido antes de 2014:</b> não há direito ao recebimento de valores.
    </li>
  </ul>

  <div style="padding:10px 12px; border-radius:14px; border:1px solid rgba(245,178,0,.30); background:rgba(245,178,0,.10); margin:10px 0 12px;">
    <div style="font-weight:800; margin-bottom:6px;">Importante</div>
    <div>
      As pessoas que ingressaram com ação individual e tiveram decisão desfavorável não podem participar da execução promovida pela Associação.
      Isso ocorre porque, quando já existe decisão judicial definitiva ou outro processo sobre o mesmo assunto, não é permitido apresentar novo pedido,
      mesmo com o envio de documentos ou adesão a acordo.
    </div>
  </div>

  <div style="padding:10px 12px; border-radius:14px; border:1px solid rgba(255,255,255,.14); background:rgba(255,255,255,.04);">
    <div style="font-weight:800; margin-bottom:6px;">Devolução de documentos</div>
    <div>
      Os associados que já entregaram a documentação, mas que não poderão participar da execução, poderão entrar em contato com a Associação
      para solicitar a devolução dos documentos apresentados.
    </div>
  </div>
</div>
<!-- BOX DE SELEÇÃO -->
          <div class="chooser" role="tablist" aria-label="Selecionar tipo de busca">
            <label class="chip active" id="chipCpf" aria-selected="true">
              <input type="radio" name="tipoBusca" value="cpf" checked />
              <i class="fa-solid fa-id-card"></i> CPF
            </label>
            <label class="chip" id="chipNome" aria-selected="false">
              <input type="radio" name="tipoBusca" value="nome" />
              <i class="fa-solid fa-user"></i> NOME
            </label>
          </div>

          <!-- CAMPO CPF -->
          <div class="field" id="boxCpf">
            <label for="cpf">CPF</label>
            <input id="cpf" type="text" inputmode="numeric" autocomplete="off" placeholder="Digite o CPF (11 números)" />
          </div>

          <!-- CAMPO NOME -->
          <div class="field hidden" id="boxNome">
            <label for="nome">NOME COMPLETO</label>
            <input id="nome" type="text" autocomplete="off" placeholder="Digite o nome completo" />
            <div class="mini">Digite o nome completo. A busca remove acentos automaticamente.</div>
          </div>

          <div class="actions" aria-label="Ações">
            <button id="btnBuscar" class="btn btn-primary" type="button">
              <i class="fa-solid fa-magnifying-glass"></i> BUSCAR
            </button>
            <button id="btnLimpar" class="btn btn-ghost" type="button">
              <i class="fa-solid fa-eraser"></i> LIMPAR
            </button>
          </div>

          <!-- STATUS SÓ APARECE DEPOIS DA BUSCA -->
          <div id="msg" class="status" aria-live="polite"></div>
          <div id="results"></div>
          <div id="docBox" class="hidden" style="margin-top:12px;">
            <div class="actions" style="justify-content:flex-start;">
              <a class="btn btn-ghost" href="https://apipmcbdf.com.br/consulta_doc_aux.html" target="_blank" rel="noopener">
                <i class="fa-solid fa-file-circle-check"></i> Confira aqui sua documentação
              </a>
            </div>
            <div class="mini" style="margin-top:8px;">
              Não assinou nada? Entre em contato com a Associação <b>com urgência</b>.
            </div>
          </div>

        </div>
      </div>

      <div class="back">
        <a href="consulta.html"><i class="fa-solid fa-arrow-left"></i> Voltar</a>
      </div>
    </div>
  </section>

  <!-- FOOTER carregado de footer.html -->
  <div id="footer-include" aria-label="Rodapé do site"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getFirestore, doc, getDoc, collection, query, where, limit, getDocs } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDoXdgj_fRuYTluJby6QOIiEYBu268lZmQ",
      authDomain: "documentos-apipmcbdf.firebaseapp.com",
      projectId: "documentos-apipmcbdf",
      storageBucket: "documentos-apipmcbdf.appspot.com",
      messagingSenderId: "422508459389",
      appId: "1:422508459389:web:bebd6b53839f77a3cd4814"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const COL = "ListaCPFs";

    const elCpf = document.getElementById("cpf");
    const elNome = document.getElementById("nome");
    const elMsg = document.getElementById("msg");
    const elResults = document.getElementById("results");
    const btnBuscar = document.getElementById("btnBuscar");
    const btnLimpar = document.getElementById("btnLimpar");

    const chipCpf = document.getElementById("chipCpf");
    const chipNome = document.getElementById("chipNome");
    const boxCpf = document.getElementById("boxCpf");
    const boxNome = document.getElementById("boxNome");

    function setMsg(text, kind = "") {
      elMsg.textContent = text;
      elMsg.className = "status show" + (kind ? " " + kind : "");
    }

    function hideMsg() {
      elMsg.textContent = "";
      elMsg.className = "status";
    }

    function clearResults() {
      elResults.innerHTML = "";
    }

    function showDoc() {
      const el = document.getElementById("docBox");
      if (el) el.classList.remove("hidden");
    }

    function hideDoc() {
      const el = document.getElementById("docBox");
      if (el) el.classList.add("hidden");
    }

    function onlyDigits(s) {
      return (s || "").replace(/\D+/g, "");
    }

    function collapseSpaces(s) {
      return (s || "").trim().replace(/\s+/g, " ");
    }

    function normalizeName(s) {
      const t = collapseSpaces(s || "");
      // Remove acentos, deixa MAIÚSCULO e remove tudo que não for letra ou espaço
      const up = t
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "")
        .toUpperCase();
      return collapseSpaces(up.replace(/[^A-Z ]+/g, ""));
    }

    function maskCpf(cpfDigits) {
      const d = (cpfDigits || "").padStart(11, "0").slice(-11);
      return d.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, "***.$2.$3-$4");
    }

    function renderResult(nome, cpfDigits) {
      clearResults();
      const box = document.createElement("div");
      box.className = "result";
      box.innerHTML = `
        <div class="name">${(nome || "CONSTA NA LISTAGEM").toString()}</div>
        <div class="cpf">CPF: <b>${maskCpf(cpfDigits)}</b></div>
      `;
      elResults.appendChild(box);
    }

    function setMode(mode) {
      if (mode === "cpf") {
        chipCpf.classList.add("active");
        chipNome.classList.remove("active");
        chipCpf.setAttribute("aria-selected", "true");
        chipNome.setAttribute("aria-selected", "false");
        boxCpf.classList.remove("hidden");
        boxNome.classList.add("hidden");
        elCpf.focus();
      } else {
        chipNome.classList.add("active");
        chipCpf.classList.remove("active");
        chipNome.setAttribute("aria-selected", "true");
        chipCpf.setAttribute("aria-selected", "false");
        boxNome.classList.remove("hidden");
        boxCpf.classList.add("hidden");
        elNome.focus();
      }
      hideMsg();
      clearResults();
      hideDoc();
    }

    chipCpf.addEventListener("click", () => setMode("cpf"));
    chipNome.addEventListener("click", () => setMode("nome"));

    async function buscarPorCPF(cpfDigits) {
      setMsg("CONSULTANDO...", "");
      clearResults();

      const ref = doc(db, COL, cpfDigits);
      const snap = await getDoc(ref);

      if (!snap.exists()) {
        setMsg("NÃO ENCONTRADO", "err");
        hideDoc();
        hideDoc();
        return;
      }

      const data = snap.data() || {};
      showDoc();
      showDoc();
      setMsg("Seu nome aparece na listagem inicial. Antes de prosseguir, verifique a documentação e aguarde a análise de elegibilidade (podem existir impedimentos jurídicos).", "ok");
      renderResult(data.nome || "", cpfDigits);
    }

    async function buscarPorNomeCompleto(nomeRaw) {
      setMsg("CONSULTANDO...", "");
      clearResults();

      const nome = normalizeName(nomeRaw);

      if (!nome || nome.split(" ").length < 2) {
        setMsg("DIGITE O NOME COMPLETO", "err");
      hideDoc();
      hideDoc();
        return;
      }

      const colRef = collection(db, COL);
      const qy = query(colRef, where("nome", "==", nome), limit(10));
      const snaps = await getDocs(qy);

      if (snaps.empty) {
        setMsg("NÃO ENCONTRADO", "err");
        hideDoc();
        return;
      }

      const first = snaps.docs[0];
      const data = first.data() || {};
      const cpfDigits = onlyDigits(first.id);


      showDoc();
      setMsg("SEU NOME CONSTA NA LISTAGEM. VERIFIQUE SE SUA DOCUMENTAÇÃO ESTÁ COMPLETA.", "ok");
      renderResult(data.nome || nome, cpfDigits || first.id);
    }

    function getSelectedMode() {
      return document.querySelector('input[name="tipoBusca"]:checked')?.value || "cpf";
    }

    async function onBuscar() {
      btnBuscar.disabled = true;
      try {
        const mode = getSelectedMode();

        if (mode === "cpf") {
          const cpfDigits = onlyDigits(elCpf.value);
          if (cpfDigits.length !== 11) {
            setMsg("CPF INVÁLIDO", "err");
            clearResults();
        hideDoc();
            return;
          }
          await buscarPorCPF(cpfDigits);
          return;
        }

        if (mode === "nome") {
          const nomeRaw = elNome.value || "";
          if (!collapseSpaces(nomeRaw)) {
            setMsg("DIGITE O NOME COMPLETO", "err");
            clearResults();
        hideDoc();
            return;
          }
          await buscarPorNomeCompleto(nomeRaw);
          return;
        }

      } catch (err) {
        console.error(err);
        setMsg("ERRO NA CONSULTA", "err");
        clearResults();
        hideDoc();
      } finally {
        btnBuscar.disabled = false;
      }
    }

    btnBuscar.addEventListener("click", onBuscar);
    btnLimpar.addEventListener("click", () => {
      elCpf.value = "";
      elNome.value = "";
      hideMsg();
      clearResults();
      hideDoc();
      // volta para CPF por padrão
      setMode("cpf");
    });

    // Enter para buscar
    elCpf.addEventListener("keydown", (e) => { if (e.key === "Enter") onBuscar(); });
    elNome.addEventListener("keydown", (e) => { if (e.key === "Enter") onBuscar(); });
    // Impede caracteres que não sejam letras/espaços no campo NOME (inclui letras com acento)
    elNome.addEventListener("input", () => {
      const cleaned = (elNome.value || "").replace(/[^\p{L} ]+/gu, "");
      if (cleaned !== elNome.value) elNome.value = cleaned;
    });

    hideDoc();
</script>

  <script>
    async function include(path, targetId) {
      const el = document.getElementById(targetId);
      if (!el) return;
      try {
        const res = await fetch(path, { cache: "no-store" });
        el.innerHTML = await res.text();
      } catch (e) {
        console.error(`Falha ao carregar ${path}`, e);
      }
    }
    // Toggle do menu (usado pelo header.html)
    function toggleMenu() {
      var menu = document.getElementById("menu");
      if (menu) menu.classList.toggle("active");
    }
    // Carrega os includes
    include('header.html', 'header-include');
    include('footer.html', 'footer-include');
  </script>

</body>
</html>
